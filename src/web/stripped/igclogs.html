<!DOCTYPE html><html><head><link rel="stylesheet" href="style.css"><meta charset='utf-8'><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta http-equiv="Refresh" content="10"><title>GXAirCom</title><script language="javascript" type="text/javascript"> var pageNumber=50; var firstTime = true; function onMessage(evt) { if (firstTime){ console.log("Received: " + evt.data); var myObj = JSON.parse(evt.data); var years = {}; for (var key of Object.keys(myObj)) { console.log(key + " -> " + myObj[key]); if (key == "igclist"){ firstTime = false; websocket.close(); let fl = myObj[key].split(";"); const divElem = document.getElementById(key); fl.forEach(fpath => { const fname = fpath.split('/').slice(-1); const year = parseInt(fname[0].split('_')[0].slice(-2)) + 2000; const month = parseInt(fname[0].split('_')[0].slice(-4,-2)); const day = parseInt(fname[0].split('_')[0].slice(-6,-4)); if (year in years){ years[year].push({'path':fpath,'fname':fname,'month':month,'day':day}); }else{ years[year] = [{'path':fpath,'fname':fname,'month':month,'day':day}]; } }); for (y in years){ var el = document.createElement("h3"); el.textContent = y; divElem.appendChild(el); years[y].forEach( t => { var el = document.createElement("p"); el.innerHTML = "<a href='/download?igc="+String(t.path)+"' download class='igc_link'>" + t.fname + "</a>"; divElem.appendChild(el); }); } } } } } var url = "ws://" + window.location.hostname + ":1337/";function init() { wsConnect(url);}function wsConnect(url) { websocket = new WebSocket(url); websocket.onopen = function(evt) { onOpen(evt) }; websocket.onclose = function(evt) { onClose(evt) }; websocket.onmessage = function(evt) { onMessage(evt) }; websocket.onerror = function(evt) { onError(evt) };}function onOpen(evt) { console.log("Connected"); doSend(JSON.stringify({ page : pageNumber }));}function onClose(evt) { console.log("Disconnected");}function onError(evt) { console.log("ERROR: " + evt.data);}function doSend(message) { console.log("Sending: " + message); websocket.send(message);}window.addEventListener("load", init, false);</script></head><body> <div style="text-align:left;display:inline-block;color:#eaeaea;min-width:340px;"> <div style='text-align:center;color:#eaeaea;'> <noscript>JavaScript aktivieren um GXAirCom benutzen zu k√∂nnen<br></noscript> <h1 id="appname"></h1> <h3 id="buildDate"></h3> <h3 id="pilot"></h3> <h3 id="myIP"></h3> </div> <style>td{padding:0px 5px;}</style> <h1>IGC File List</h1> <div id="test"></div> <div id="igclist"> </div> <div></div> <p></p> <table style="width:100&#37;"> <tr> <td style="width:100&#37;"> <button onClick="location.href='/index.html'">main menu</button> </td> </tr> </table> <p></p> <div style='text-align:right;font-size:11px;'><hr><a href='https://www.getronix.at' target='_blank' style='color:#aaa;'>GXAirCom by Gerald Eichler</a> </div> </div></body></html>